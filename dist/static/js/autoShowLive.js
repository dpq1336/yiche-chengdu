function getData(e,a){var t;return $.ajax({type:"GET",data:{param:JSON.stringify(a)},dataType:"json",url:e,async:!1,success:function(e){t=e}}),t}function postData(e,a){var t;return $.ajax({type:"POST",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",dataType:"json",url:e,async:!1,success:function(e){t=e}}),t}$(".tabbox li").click(function(){$(this).addClass("active").siblings().removeClass("active");var e=$(this).index();switch(e){case 0:videoParamData.pageIndex=0,videoParamData.statuses="1,2",renderDat={},videoList=[],$("#videoObj").html(template("video-tpl",renderDat)),getVideoData();break;case 1:videoParamData.pageIndex=0,videoParamData.statuses="4",renderDat={},videoList=[],$("#videoObj").html(template("video-tpl",renderDat)),getVideoData();break;default:return}$(this).addClass("active").siblings().removeClass("active"),$(".main_card>div").eq(e).show().siblings().hide()}),$(".change").click(function(){sortExpertList=renderDat.expertList,sortExpertList.sort(randomSort),renderDat.expertList=sortExpertList,console.log("换一换",renderDat.expertList),$("#yicheObj").html(template("yiche-tpl",renderDat))});var publicParam={cid:"502",ver:"6.6.3",uid:"45022498"};function setParamFun(e){return publicParam.param=e,publicParam}function randomSort(e,a){return.5<Math.random()?-1:1}$("#yicheObj").on("click","a.btn_fllow",function(e){console.log("换一换--关注",$(this).attr("uid")),isLoginFlag&&(1==postData(baseUrl+"/web_exhibition/api/v1/common/follow",setParamFun({uid:uid||"45022498",type:1,followUid:$(this).attr("uid")})).status?(console.log("关注成功"),$(this).addClass("btn_gray"),$(this).html("已关注"),$(this).removeClass("btn_fllow")):console.log("关注失败"))}),$("#yicheObj").on("click","a.btn_gray",function(e){console.log("换一换--取消关注",$(this).attr("uid")),isLoginFlag&&(1==postData(baseUrl+"/web_exhibition/api/v1/common/follow",setParamFun({uid:uid||"45022498",type:2,followUid:$(this).attr("uid")})).status?(console.log("取消关注成功"),$(this).removeClass("btn_gray"),$(this).addClass("btn_fllow"),$(this).html("关注TA")):console.log("取消关注失败"))});var baseUrl="https://mapi.yiche.com",uid=0,isLoginFlag=window.Bitauto.Login.result.isLogined;isLoginFlag&&(uid=window.Bitauto.Login.result.userId);var dataList=[],bannerList=[],expertList=[],videoList=[],renderDat={},bannerUrl=baseUrl+"/web_exhibition/api/v1/common/get_focus_frame?cid=502&ver=6.6.3&uid="+uid,banneParamData={frameId:152},expertUrl=baseUrl+"/web_exhibition/api/v1/common/author_recommend_list?cid=502&ver=6.6.3&uid="+uid,expertParamData={frameId:1,categoryIds:"122"},videoUrl=baseUrl+"/web_exhibition/api/v1/live_broadcast/get_live_broadcast_list?cid=502&ver=6.6.3&uid="+uid,videoParamData={tagId:0,categroyId:0,statuses:"1,2",beginDate:"2019-01-01",endDate:"2019-12-31",pageIndex:0,pageSize:10,manualRecommendKey:"Guangzhou2018RecommendUrl"},videoHkParamData={tagId:0,categroyId:0,statuses:"4",beginDate:"2019-01-01",endDate:"2019-12-31",pageIndex:0,pageSize:10,manualRecommendKey:"Guangzhou2018RecommendUrl"},loadMore=!0;function sortArr(e){console.log("data",e);var i=[];return e.forEach(function(e,a){for(var t=0;t<i.length;t++)if(i[t].timeLabel==e.timeLabel)return void i[t].listInfo.push({mobileImageUrl:e.mobileImageUrl,status:e.status,userName:e.userName,title:e.title,key:handleTimeData(e.key),url:e.url,videoId:e.videoId});i.push({timeLabel:e.timeLabel,listInfo:[{mobileImageUrl:e.mobileImageUrl,status:e.status,userName:e.userName,title:e.title,key:handleTimeData(e.key),url:e.url,videoId:e.videoId}]})}),i}function handleTimeData(e){return e=e&&(e=e.split("-"))[0]+"-"+e[1]+"-"+e[2]}var zbFlag=!1,hkFlag=!1;function isVideoList(){console.log("请求两次接口看是否有数据");var e=getData(videoUrl,videoParamData);(zbFlag=0!=e.data.list.length)?$(".zb").addClass("active"):$(".zb").hide();var a=getData(videoUrl,videoHkParamData);(hkFlag=0!=a.data.list.length)?zbFlag||$(".hk").addClass("active"):$(".hk").hide(),videoParamData.statuses="4",getVideoData()}function getVideoData(){var e=getData(videoUrl,videoParamData);if(1==e.status&&e.data.list){if(console.log("视频列表数据===前",videoList),videoList=videoList.concat(e.data.list),tempArr=sortArr(videoList),console.log("videoParamData.pageIndex",videoParamData.pageIndex),videoParamData.pageIndex*videoParamData.pageSize>=e.data.count&&0==e.data.list.length)return console.log("111页面 和返回条数为0 不加载接口"),loadMore=!1,void $(".load_more").text("");console.log("222"),loadMore=!0,renderDat.videoList=tempArr,console.log("videoList0000000000000",renderDat),$("#videoObj").html(template("video-tpl",renderDat))}}function getBannerData(){var e=getData(bannerUrl,banneParamData);1==e.status&&e.data&&(bannerList=e.data,renderDat.bannerListA=bannerList.slice(0,1),renderDat.bannerListB=bannerList.slice(1,5),$("#bannerObj").html(template("banner-tpl",renderDat)))}function getExpertData(){var e=getData(expertUrl,expertParamData);if(1==e.status&&e.data){expertList=e.data;for(var a=0;a<expertList.length;a++)null!=expertList[a].avatarpath?expertList[a].avatarpath=expertList[a].avatarpath.replace(/\{0\}/,120):expertList[a].avatarpath="https://pic.baa.bitautotech.com/newavatar/120.jpg";renderDat.expertList=expertList.slice(0,10);var t={};t.isLogin=isLoginFlag,t.expertList=renderDat.expertList,console.log("新数组",t),console.log("renderDat.expertList121212121==========",t),$("#yicheObj").html(template("yiche-tpl",t))}}isVideoList(),$(window).on("scroll",function(){var e=document.documentElement.scrollTop||document.body.scrollTop;(document.documentElement.scrollHeight||document.body.scrollHeight)-(document.documentElement.clientHeight||document.body.clientHeight)-100<=e&&(console.log("loadMore",loadMore),loadMore&&(videoParamData.pageIndex+=1,$(".load_more").text("正在加载..."),getVideoData()))}),getBannerData(),getExpertData();
//# sourceMappingURL=autoShowLive.js.map
