{"version":3,"sources":["indexUtitls.js"],"names":["getQueryString","name","reg","RegExp","r","window","location","search","substr","match","unescape","timmer","timeChange","time","minutes","parseInt","seconds","playMusicFn","myAudio","document","getElementById","paused","allTime","getAttribute","setInterval","currentTime","clearInterval","$","html","play","pause","setContentTpl","contentData","contentTpl","createTime","useTime","type","j","tagInfoList","length","rating","i","content","topicImages","split","k","replace","append","ajax","url","data","topicId","sign","dataType","success","res","jsonData","isSuccess","userInfo","user","roles","caridentification","state","defaultcar","masterbrandid","iconUrl","avatarpath","showname","carInfo","topicInfo","carName","tempClassName","isDigest","isRecommend","isAuthen","purchaseDate","buyCarInfo","purchasePrice","purchaseCityName","fuelValue","carType","musicTpl","musicDate","metaDuration","metaUrl","id","haveAddTopic","addTopicList","z","addCreateTime","addTagsContent","addTopicImages","schemeUrl","click","href","_url","this","attr","t","Date","now","setTimeout","show","dataToTemplate","error","xhr","console","log"],"mappings":"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","file":"indexUtitls.js","sourcesContent":["function getQueryString(name) {\n    var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\n    var r = window.location.search.substr(1).match(reg);\n    if (r != null) return unescape(r[2]);\n    return null;\n}\nvar timmer = null;\n//播放时间\nfunction timeChange(time) {//默认获取的时间是时间戳改成我们常见的时间格式\n    //分钟\n    var minute = time / 60;\n    var minutes = parseInt(minute);\n    if (minutes < 10) {\n        minutes = \"0\" + minutes;\n    }\n    //秒\n    var second = time % 60;\n    seconds = parseInt(second);\n    if (seconds < 10) {\n        seconds = \"0\" + seconds;\n    }\n    var allTime = \"\" + minutes + \"\" + \":\" + \"\" + seconds + \"\";\n    return allTime;\n}\nfunction playMusicFn() {\n    var myAudio = document.getElementById('music');\n    if (myAudio.paused) {\n        var allTime = myAudio.getAttribute('data-allTime');\n        timmer = setInterval(function () {\n\n            var currentTime = myAudio.currentTime;\n\n            if (allTime - currentTime <= 0) {\n                clearInterval(timmer);\n\n                $(\".des-music-date\").html(timeChange(allTime));\n            } else {\n                $(\".des-music-date\").html(timeChange(allTime - currentTime));\n            }\n        }, 1000);\n        myAudio.play();\n    } else {\n        clearInterval(timmer);\n        myAudio.pause();\n    }\n\n}\n\n$(function () {\n    function getTopicsById() {\n        $.ajax({\n            type: 'GET',\n           // url: 'https://mapi.yiche.com/app_review/api/v1/review/web/getTopicsByIds',\n           url: 'http://mapi.yiche.com/app_review/api/v1/review/web/getTopicsByIds',\n            data: {\n                topicId: getQueryString(\"topicId\"),\n                sign: getQueryString(\"sign\")\n            },\n            dataType: 'json',\n            success: function (res) {\n                dataToTemplate(res.data);\n            },\n            error: function (xhr, type) {\n                console.log(\"网络出错，请重试\");\n            }\n        })\n    }\n    function dataToTemplate(jsonData) {\n        if (jsonData) {\n            if (jsonData.isSuccess == 1) {\n                var userInfo = '<img class=\"user-photo\" src=\"{avatarpath}\" /> \\\n                                       <span class=\"cm-user-nick\">{showname}</span>';\n                if (jsonData.user && jsonData.user.roles && jsonData.user.roles.caridentification && jsonData.user.roles.caridentification.state && jsonData.user.roles.caridentification.defaultcar) {\n                    var masterbrandid = jsonData.user.roles.caridentification.defaultcar.masterbrandid;\n                    var iconUrl = 'https://image.bitautoimg.com/yc-h5/comment/images/img_headpic@3x.png';\n                    if (masterbrandid) {\n                        iconUrl = 'https://image.bitautoimg.com/bt/car/default/images/logo/masterbrand/png/100/m_' + masterbrandid + '_100.png';\n                    }\n                    userInfo += '<span class=\"cm-user-car\"><img class=\"user-photo\" src=\"' + iconUrl + '\" /><span>车主</span></span>';\n                    userInfo = userInfo.replace('{avatarpath}',  jsonData.user.avatarpath&&jsonData.user.avatarpath.replace(\"{0}\", 120)).replace('{showname}', jsonData.user.showname)\n                }else{\n                    userInfo=\"\";\n                }\n                \n                $(\".cm-user-info\").html(userInfo);\n\n\n                var carInfo = '<div class=\"cm-car-item cm-car-r\"><div class=\"cm-car-title\">{carName}</div></div>';\n                carInfo = carInfo.replace('{carName}', jsonData.topicInfo.carName);\n                carInfo += '<div class=\"cm-type\">'\n                var tempClassName = '';\n                if (jsonData.topicInfo.isDigest == 1 || jsonData.topicInfo.isRecommend == 1) {\n                    tempClassName = \"jh\";\n                    jsonData.topicInfo.isRecommend == 1 ? tempClassName = \"tj\" : null;\n                    carInfo += '<div class=\"' + tempClassName + '\"></div>'\n                }\n\n                if (jsonData.topicInfo.isAuthen == 1) {\n                    carInfo += '<div class=\"rz\"></div>'\n                }\n\n                carInfo += '</div>'\n\n                $(\".cm-car-info\").html(carInfo);\n                var carInfo = '';\n                if (jsonData.topicInfo.purchaseDate) {\n                    carInfo += '<span class=\"des-time\">' + jsonData.topicInfo.purchaseDate + '提车</span>'\n                }\n                carInfo += '<span class=\"des-star-lable\">综合评价 </span>';\n                for (var i = 1; i <= 5; i++) {\n                    if ((jsonData.topicInfo.rating / 2) >= i) {\n                        carInfo += '<img class=\"star\" src=\"https://image.bitautoimg.com/yc-h5/comment/images/star.png\">'\n                    } else {\n                        carInfo += '<img class=\"star\" src=\"https://image.bitautoimg.com/yc-h5/comment/images/star-gray.png\">'\n                    }\n                }\n\n                $(\".cm-car-des-top\").html(carInfo);\n\n                var buyCarInfo = '<div class=\"des-bot-item\">\\\n                                        <div class=\"des-bot-title\">裸车价</div>\\\n                                        <div class=\"des-bot-value c_red\">{purchasePrice}</div>\\\n                                    </div>\\\n                                    <div class=\"des-bot-item\">\\\n                                        <div class=\"des-bot-title\">购车地</div>\\\n                                        <div class=\"des-bot-value\">{purchaseCityName}</div>\\\n                                    </div>' ;\n                buyCarInfo = buyCarInfo.replace('{purchasePrice}', jsonData.topicInfo.purchasePrice ? jsonData.topicInfo.purchasePrice + '万元' : '暂无').replace('{purchaseCityName}', jsonData.topicInfo.purchaseCityName ? jsonData.topicInfo.purchaseCityName : '暂无');\n                var fuelValue = jsonData.topicInfo.fuelValue;\n                if (jsonData.topicInfo.carType == 1) {\n                    if (!fuelValue) {\n                        fuelValue = '暂无';\n                    } else {\n                        fuelValue = fuelValue + 'L/100km';\n                    }\n                    buyCarInfo += '<div class=\"des-bot-item\"> <div class=\"des-bot-title\">油耗</div>';\n                    buyCarInfo += '<div class=\"des-bot-value\">' + fuelValue + '</div></div>';\n                } else {\n\n                    if (!fuelValue) {\n                        fuelValue = '暂无';\n                    } else {\n                        fuelValue = fuelValue + 'km';\n                    }\n                    buyCarInfo += '<div class=\"des-bot-item\"> <div class=\"des-bot-title\">续航</div>';\n                    buyCarInfo += '<div class=\"des-bot-value\">' + fuelValue + '</div></div>';\n                }\n\n                $(\".cm-car-des-bot\").html(buyCarInfo);\n                var musicTpl = '';\n                if (jsonData.topicInfo.dataType == 3) {\n                    var musicDate = timeChange(jsonData.topicInfo.metaDuration || 0);\n                    musicTpl += '<div class=\"des-music-item\" onClick=\"playMusicFn()\"><audio id=\"music\" data-allTime=\"' + jsonData.topicInfo.metaDuration + '\" src=\"' + jsonData.topicInfo.metaUrl + '\" style=\"opacity:0;\"> </audio><div class=\"des-music-icon\"></div> <div class=\"des-music-date\">' + musicDate + '</div></div>'\n                }\n                $(\".cm-car-des\").append(musicTpl);\n                setContentTpl({\n                    createTime: jsonData.topicInfo.createTime,\n                    tagInfoList: jsonData.topicInfo.tagInfoList,\n                    topicImages: jsonData.topicInfo.topicImages,\n                    useTime: jsonData.topicInfo.useTime,\n                    id: 0,\n\n                });\n\n                if (jsonData.topicInfo.haveAddTopic == 1) {\n                    var addTopicList = jsonData.topicInfo.addTopicList;\n                    for (var z = 0; z < addTopicList.length; z++) {\n                        setContentTpl({\n                            createTime: addTopicList[z].addCreateTime,\n                            tagInfoList: addTopicList[z].addTagsContent,\n                            topicImages: addTopicList[z].addTopicImages,\n                            useTime: addTopicList[z].useTime,\n                            type: 1,\n\n                        });\n                    }\n                }\n                if (jsonData.topicInfo.schemeUrl) {\n                    var schemeUrl=jsonData.topicInfo.schemeUrl;\n                \n                    \n                }\n                $(\".download-btn\").click(function(){\n                    \n                    location.href=\"bitauto.yicheapp://yiche.app/xuanche.reputationdetail?id=2370806492237952\";\n                    var _url= $(this).attr(\"data-url\");\n                     t = Date.now();\n                     setTimeout(function(){\n                         if (Date.now() - t < 1200) {\n                             location.href = _url\n                         }\n                     }, 1000);\n                     return false;\n                 });\n                \n                $(\".cm-no-update\").show();\n            } else {\n                $(\"#cm-update\").show();\n            }\n        } else {\n            $(\"#cm-error\").show();\n        }\n    }\n\n    function setContentTpl(contentData) {\n        var contentTpl = '<div class=\"cm-content-date\">' + contentData.createTime;\n        if (contentData.useTime) {\n            contentTpl += '<span class=\"cm-content-month\">用车' + contentData.useTime + '</span>';\n        }\n        if (contentData.type == 1) {\n            contentTpl += '<span class=\"cm-content-tag\">追评</span>';\n        }\n\n        contentTpl += '</div>';\n\n        for (var j = 0; j < contentData.tagInfoList.length; j++) {\n            contentTpl += '<div class=\"cm-content-con\"><div class=\"cm-tag-name\"><span class=\"cm-tag-lable\">' + contentData.tagInfoList[j].name + '</span>';\n            if (contentData.tagInfoList[j].rating) {\n                for (var i = 1; i <= 5; i++) {\n                    if ((contentData.tagInfoList[j] / 2) >= i) {\n                        contentTpl += '<img class=\"star\" src=\"https://image.bitautoimg.com/yc-h5/comment/images/star.png\">'\n                    } else {\n                        contentTpl += '<img class=\"star\" src=\"https://image.bitautoimg.com/yc-h5/comment/images/star-gray.png\">'\n                    }\n                }\n            }\n            contentTpl += '</div>'\n            contentTpl += '<div class=\"cm-tag-info\">' + contentData.tagInfoList[j].content + '</div></div>';\n        }\n        var topicImages = contentData.topicImages;\n        contentTpl += '<div class=\"cm-content-imgs\">';\n        if (topicImages) {\n            topicImages = topicImages.split(',');\n        }\n        for (var k = 0; k < topicImages.length; k++) {\n            contentTpl += '<img src=\"' + topicImages[k].replace('{0}', 375).replace('{1}', 0) + '\" >'\n        }\n        contentTpl += '</div>'\n        if (contentData.type == 0) {\n            $(\"#f-content\").html(contentTpl);\n        } else {\n            $(\"#s-content\").append(contentTpl);\n        }\n    };\n    getTopicsById();\n})"]}